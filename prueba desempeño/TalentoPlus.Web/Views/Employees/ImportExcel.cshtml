@{
    ViewData["Title"] = "Importar Empleados desde Excel";
}

<div class="max-w-4xl mx-auto">
    <!-- Header -->
    <div class="mb-8">
        <h1 class="text-4xl font-bold text-gray-900">Importar Empleados desde Excel</h1>
        <p class="text-gray-600 mt-1">Sube un archivo Excel para importar o actualizar empleados</p>
    </div>

    <!-- Success Message -->
    @if (ViewBag.Message != null)
    {
        <div class="card bg-green-50 border-l-4 border-green-500 mb-6">
            <div class="flex justify-between items-start">
                <p class="text-green-900">@ViewBag.Message</p>
                <button type="button" class="text-green-600 hover:text-green-800" onclick="this.parentElement.parentElement.style.display='none';">‚úï</button>
            </div>
        </div>
    }

    <!-- File Format Guide -->
    <div class="card mb-6">
        <div class="bg-cyan-50 border-b border-gray-200 px-6 py-4">
            <h2 class="text-lg font-semibold text-gray-900">üìÑ Formato de Archivo Excel</h2>
        </div>
        <div class="p-6">
            <p class="text-gray-700 font-medium mb-4">Tu archivo Excel debe tener las siguientes columnas en este orden:</p>
            <ol class="space-y-2 text-gray-700 list-decimal list-inside">
                <li><strong>Nombre</strong> - Nombre del empleado</li>
                <li><strong>Apellido</strong> - Apellido del empleado</li>
                <li><strong>Documento</strong> - N√∫mero de C√©dula/ID</li>
                <li><strong>Correo</strong> - Direcci√≥n de correo electr√≥nico</li>
                <li><strong>Cargo</strong> - Posici√≥n del trabajo</li>
                <li><strong>Salario</strong> - Salario anual (num√©rico)</li>
                <li><strong>Fecha Ingreso</strong> - Fecha de ingreso (formato YYYY-MM-DD)</li>
                <li><strong>Estado</strong> - Activo, Vacaciones, o Inactivo</li>
                <li><strong>Nivel Educativo</strong> - Profesional, Postgrado, etc.</li>
                <li><strong>Departamento</strong> - Nombre del departamento</li>
            </ol>
        </div>
    </div>

    <!-- Upload Form -->
    <div class="card mb-6">
        <div class="bg-gray-50 border-b border-gray-200 px-6 py-4">
            <h2 class="text-lg font-semibold text-gray-900">üì§ Cargar Archivo</h2>
        </div>
        <div class="p-6">
            <form asp-action="ImportExcel" method="post" enctype="multipart/form-data" class="space-y-6">
                <div asp-validation-summary="ModelOnly" class="bg-red-50 border-l-4 border-red-500 text-red-700 p-4">
                    <p class="font-semibold">Por favor corrige los siguientes errores:</p>
                </div>

                <div>
                    <label for="fileInput" class="block text-sm font-medium text-gray-700 mb-2">Selecciona un Archivo Excel (.xlsx)</label>
                    <input 
                        type="file" 
                        id="fileInput" 
                        name="arquivo" 
                        accept=".xlsx" 
                        class="block w-full text-sm text-gray-700
                            file:mr-4 file:py-2 file:px-4
                            file:rounded-lg file:border-0
                            file:text-sm file:font-semibold
                            file:bg-blue-50 file:text-blue-700
                            hover:file:bg-blue-100
                            cursor-pointer" 
                        required 
                    />
                    <p class="text-sm text-gray-600 mt-1">Solo se soportan archivos .xlsx</p>
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-3">
                    <button type="submit" class="btn-primary">
                        ‚òÅÔ∏è Importar Empleados
                    </button>
                    <a asp-action="Index" class="btn-secondary">
                        ‚Üê Cancelar
                    </a>
                </div>
            </form>
        </div>
    </div>

    <!-- Important Notes -->
    <div class="card border-l-4 border-yellow-500 bg-yellow-50">
        <div class="p-6">
            <h3 class="font-semibold text-gray-900 mb-4">‚ö†Ô∏è Notas Importantes:</h3>
            <ul class="space-y-2 text-gray-700 list-disc list-inside">
                <li>El sistema crear√° o actualizar√° autom√°ticamente los empleados bas√°ndose en el correo y documento</li>
                <li>Si un empleado con el mismo correo o documento existe, ser√° actualizado</li>
                <li>Si el nombre del departamento no existe, el empleado ser√° asignado al primer departamento</li>
                <li>Las filas vac√≠as ser√°n omitidas</li>
                <li>Aseg√∫rate de que todos los campos requeridos est√©n rellenos (Nombre, Apellido, Correo, Documento)</li>
            </ul>
        </div>
    </div>
</div>
